#
# Okta Management
# Allows customers to easily access the Okta Management APIs
# Version: 3.0.0
# Contact: devex-public@okta.com
# Generated by OpenAPI Generator: https://openapi-generator.tech
#

Describe -tag 'Okta.PowerShell' -name 'OktaOktaGroupApi' {
    Context 'Invoke-OktaActivateGroupRule' {
        It 'Test Invoke-OktaActivateGroupRule' {
            #$TestResult = Invoke-OktaActivateGroupRule -RuleId "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }

    Context 'Add-OktaGroupOwner' {
        It 'Test Add-OktaGroupOwner' {
            #$TestResult = Add-OktaGroupOwner -GroupId "TEST_VALUE" -GroupOwner "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }

    Context 'Add-OktaUserToGroup' {
        It 'Test Add-OktaUserToGroup' {
            #$TestResult = Add-OktaUserToGroup -GroupId "TEST_VALUE" -UserId "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }

    Context 'New-OktaGroup' {
        It 'Test New-OktaGroup' {
            $Content = '{"id":"00gbglv3gopEupBN61d7","created":"2023-11-22T15:38:31.000Z","lastUpdated":"2023-11-22T15:38:31.000Z","lastMembershipUpdated":"2023-11-22T15:38:31.000Z","objectClass":["okta:user_group"],"type":"OKTA_GROUP","profile":{"name":"New Group","description":null}}'
                        | ConvertFrom-Json
            
            $Response = @{
                Response  = $Content
                StatusCode = 200
                Headers = @{ "Content-Type" = @("application/json")}
            }

            Mock -ModuleName Okta.PowerShell Invoke-OktaApiClient { return $Response } -Verifiable

            $NewGroup = [PSCustomObject]@{
                Profile = [PSCustomObject]@{
                    Name = "New Group"
                }
            }

            $TestResult = New-OktaGroup -Group $NewGroup

            Assert-MockCalled -ModuleName Okta.PowerShell Invoke-OktaApiClient -Times 1

            $TestResult.Id | Should -Be "00gbglv3gopEupBN61d7"
            $TestResult.Profile.Name | Should -Be "New Group"
            [string]::IsNullOrEmpty($TestResult.Profile.Description) | Should -Be $True
            $TestResult.Created.ToString('yyyy-MM-dd') | Should -Be "2023-11-22"
        }
    }

    Context 'New-OktaGroupRule' {
        It 'Test Initialize-OktaGroupRule' {
            
            $AssignUserToGroups = [PSCustomObject]@{ GroupIds = @("groupId")}
            $Actions = Initialize-OktaGroupRuleAction -AssignUserToGroups $AssignUserToGroups

            $PeopleGroups = [PSCustomObject]@{ Exclude = @("groupId") }
            $PeopleUsers = [PSCustomObject]@{ Exclude = @("userId") }
            
            $People = Initialize-OktaGroupRulePeopleCondition -Groups $PeopleGroups -Users $PeopleUsers
            $Expression = Initialize-OktaGroupRuleExpression -Type "urn:okta:expression:1.0" -Value  "user.countryCode=='US'"
            $Conditions = Initialize-OktaGroupRuleConditions -Expression $Expression -People $People

            $GroupRule = Initialize-OktaGroupRule -Actions $Actions -Conditions $Conditions -Name "New Rule" -Type "group_rule"

            $GroupRule.Name | Should -Be "New Rule"
            $GroupRule.Type | Should -Be "group_rule"
            $GroupRule.Conditions.People.Users.Exclude.Count | Should -Be 1
            $GroupRule.Conditions.People.Users.Exclude[0] | Should -Be "userId"
            $GroupRule.Conditions.People.Groups.Exclude.Count | Should -Be 1
            $GroupRule.Conditions.People.Groups.Exclude[0] | Should -Be "groupId"
            $GroupRule.Conditions.Expression.Value | Should -Be "user.countryCode=='US'"
            $GroupRule.Conditions.Expression.Type | Should -Be "urn:okta:expression:1.0"
            $GroupRule.Actions.AssignUserToGroups.GroupIds.Count | Should -Be 1
            $GroupRule.Actions.AssignUserToGroups.GroupIds[0] | Should -Be "groupId"

        }

        It 'Test New-OktaGroupRule' {

            $Content = '{"type":"group_rule","id":"0prbgm3u2mdL39RwF1d7","status":"INACTIVE","name":"New Rule","conditions":{"people":{"users":{"exclude":["userId"]},"groups":{"exclude":["groupId"]}},"expression":{"value":"user.countryCode==US","type":"urn:okta:expression:1.0"}},"actions":{"assignUserToGroups":{"groupIds":["groupId"]}},"allGroupsValid":true}'
            | ConvertFrom-Json

            $Response = @{
                Response  = $Content
                StatusCode = 200
                Headers = @{ "Content-Type" = @("application/json")}
            }

            Mock -ModuleName Okta.PowerShell Invoke-OktaApiClient { return $Response } -Verifiable

            $GroupRule = New-OktaGroupRule -GroupRule @{}
            $GroupRule.Name | Should -Be "New Rule"
            $GroupRule.Type | Should -Be "group_rule"
            $GroupRule.Status | Should -Be "INACTIVE"
            $GroupRule.Conditions.People.Users.Exclude.Count | Should -Be 1
            $GroupRule.Conditions.People.Users.Exclude[0] | Should -Be "userId"
            $GroupRule.Conditions.People.Groups.Exclude.Count | Should -Be 1
            $GroupRule.Conditions.People.Groups.Exclude[0] | Should -Be "groupId"
            $GroupRule.Conditions.Expression.Value | Should -Be "user.countryCode==US"
            $GroupRule.Conditions.Expression.Type | Should -Be "urn:okta:expression:1.0"
            $GroupRule.Actions.AssignUserToGroups.GroupIds.Count | Should -Be 1
            $GroupRule.Actions.AssignUserToGroups.GroupIds[0] | Should -Be "groupId"

        }
    }

    Context 'Invoke-OktaDeactivateGroupRule' {
        It 'Test Invoke-OktaDeactivateGroupRule' {
            #$TestResult = Invoke-OktaDeactivateGroupRule -RuleId "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }

    Context 'Invoke-OktaDeleteGroup' {
        It 'Test Invoke-OktaDeleteGroup' {

            $Response = @{
                Response  = $null
                StatusCode = 200
                Headers = @{ "Content-Type" = @("application/json")}
            }

            Mock -ModuleName Okta.PowerShell Invoke-OktaApiClient { return $Response } -Verifiable

            Invoke-OktaDeleteGroup -GroupId "foo"
            Assert-MockCalled -ModuleName Okta.PowerShell Invoke-OktaApiClient -Times 1
        }
    }

    Context 'Invoke-OktaDeleteGroupOwner' {
        It 'Test Invoke-OktaDeleteGroupOwner' {
            #$TestResult = Invoke-OktaDeleteGroupOwner -GroupId "TEST_VALUE" -OwnerId "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }

    Context 'Invoke-OktaDeleteGroupRule' {
        It 'Test Invoke-OktaDeleteGroupRule' {
            #$TestResult = Invoke-OktaDeleteGroupRule -RuleId "TEST_VALUE" -RemoveUsers "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }

    Context 'Get-OktaGroup' {
        It 'Test Get-OktaGroup' {
            #$TestResult = Get-OktaGroup -GroupId "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }

    Context 'Get-OktaGroupOwners' {
        It 'Test Get-OktaGroupOwners' {
            #$TestResult = Get-OktaGroupOwners -GroupId "TEST_VALUE" -Filter "TEST_VALUE" -After "TEST_VALUE" -Limit "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }

    Context 'Get-OktaGroupRule' {
        It 'Test Get-OktaGroupRule' {
            #$TestResult = Get-OktaGroupRule -RuleId "TEST_VALUE" -Expand "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }

    Context 'Invoke-OktaListAssignedApplicationsForGroup' {
        It 'Test Invoke-OktaListAssignedApplicationsForGroup' {
            #$TestResult = Invoke-OktaListAssignedApplicationsForGroup -GroupId "TEST_VALUE" -After "TEST_VALUE" -Limit "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }

    Context 'Invoke-OktaListGroupRules' {
        It 'Test Invoke-OktaListGroupRules' {
            #$TestResult = Invoke-OktaListGroupRules -Limit "TEST_VALUE" -After "TEST_VALUE" -Search "TEST_VALUE" -Expand "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }

    Context 'Invoke-OktaListGroupUsers' {
        It 'Test Invoke-OktaListGroupUsers' {
            #$TestResult = Invoke-OktaListGroupUsers -GroupId "TEST_VALUE" -After "TEST_VALUE" -Limit "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }

    Context 'Invoke-OktaListGroups' {
        It 'Test Invoke-OktaListGroups' {
            #$TestResult = Invoke-OktaListGroups -Q "TEST_VALUE" -Filter "TEST_VALUE" -After "TEST_VALUE" -Limit "TEST_VALUE" -Expand "TEST_VALUE" -Search "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }

    Context 'Remove-OktaUserFromGroup' {
        It 'Test Remove-OktaUserFromGroup' {
            #$TestResult = Remove-OktaUserFromGroup -GroupId "TEST_VALUE" -UserId "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }

    Context 'Update-OktaGroup' {
        It 'Test Update-OktaGroup' {
            #$TestResult = Update-OktaGroup -GroupId "TEST_VALUE" -Group "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }

    Context 'Update-OktaGroupRule' {
        It 'Test Update-OktaGroupRule' {
            #$TestResult = Update-OktaGroupRule -RuleId "TEST_VALUE" -GroupRule "TEST_VALUE"
            #$TestResult | Should -BeOfType TODO
            #$TestResult.property | Should -Be 0
        }
    }
}
